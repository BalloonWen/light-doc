---
date: 2016-11-06T10:24:22-05:00
title: Traceability
---
#

For microservices architecture, a request sent from client may pass 
through several services to the backend respository/Book of Record 
and then response is returned in the reverse path. If there is an 
error in the call tree, we need to identify where is the problem 
during runtime. Also, for some mission critical applications, the 
entire call tree must be in the audit log to meet regulatory compliance
requirement. For example, banking applications.  

The framework has two tracing IDs built in and X-Traceability-Id is one 
of them that handled by this middleware component. Another one is 
X-Correlation-Id which is documented in [correlation](https://networknt.github.io/light-4j/middleware/correlation/). 
 
 
X-Traceability-Id is generated by the original client and might not 
be unique across the API domain. It is unique for that particular 
client though. It is usually a sequence number generated from database
or a UUID. The usage of this id is to debug broken transactions as every 
service will have this id logged once if the service is called and will 
return this id in response header to the caller.  

Every API/Service is responsible to pass the X-Traceability-Id (from 
request header) to the next service (set the request header by Client 
when calling another service).  

Not all client will supply traceability_id so this is an optional field 
in the request header. If it doesn't exist, do nothing. If it does exist, 
the framework is responsible to pass it to the next API in the chain or 
pass to the Book of Record.

It is recommended that X-Traceability-Id should be persisted in Backend 
Repository/Book of Record. However, this might not be possible for some 
legacy application, i.e. mainframe applications. 


It should only be logged once in the audit log once your API processing 
is done and successful.

# Configuration

The configuration for this handler is very simple, just control if this 
handler is enabled or not.
It will only be plugged into the request/response chain if enabled is 
true in the traceability.yml

```
description: Traceability Handler
enabled: true
```

# Calling sequence

This handler will be loaded after metric handler.

# Dependencies

This handler set the response header from request header; however, to make 
it work across services, it depends the following middleware or component 
to work. 

* [Audit](https://networknt.github.io/light-4j/middleware/audit/) 
to log the traceabilityId to the audit log file.
* [Client](https://networknt.github.io/light-4j/other/client/) 
to pass the X-Traceability-Id to the next service through HttpRequest Header.

